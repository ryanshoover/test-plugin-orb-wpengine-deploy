version: 2.1

orbs:
    wpengine: ryanshoover/wpengine@0.4

workflows:
    version: 2

    test-deploy:
        jobs:
            - wpengine/lint:
                context: DXT
                filters:
                    branches:
                        only: /.*/
                    tags:
                        only: /^\d+\.\d+\.\d+$/
            - wpengine/codeception:
                context: DXT
                package_name: PACKAGE_NAME
                package_type: plugin|theme
                filters:
                    branches:
                        only: /.*/
                    tags:
                        only: /^\d+\.\d+\.\d+$/
            - wpengine/deploy_fury:
                context: DXT
                filters:
                    branches:
                        ignore: /.*/
                    tags:
                        only: /^\d+\.\d+\.\d+$/
                requires:
                    - wpengine/lint
                    - wpengine/codeception
